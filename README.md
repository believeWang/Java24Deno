# Java Stream Gatherer 工作原理：四個角色的詳細說明

以下是對 Java Stream 中 **Gatherer** 工作原理的詳細介紹，特別聚焦於其四個核心角色：**Initializer（初始化器）**、**Integrator（整合器）**、**Combiner（合併器）** 和 **Finisher（結束器）**。這些角色共同定義了 Gatherer 的數據處理流程，我將逐一解釋它們的功能、作用、實現方式，並提供示例來說明它們如何協同工作。

---

## Gatherer 的整體工作原理
Gatherer 是 Java Stream API 中的一種中間操作，通過 `Stream.gather(Gatherer<T, A, R>)` 方法將輸入流（類型為 `T`）轉換為輸出流（類型為 `R`），並允許自訂轉換邏輯。其核心思想是像一個“數據處理器”：
- 從上游（輸入流）接收元素。
- 根據自訂邏輯處理這些元素（可能維護內部狀態 `A`）。
- 將結果推送至下游（輸出流）。

Gatherer 的四個角色共同實現這個處理過程，每個角色有特定的職責，且有些是可選的。以下是詳細介紹：

---

## 1. Initializer（初始化器）
- **類型**：`Supplier<A>`
- **職責**：提供 Gatherer 的初始狀態（`A`），在流處理開始前執行一次。
- **是否必需**：可選。如果未提供，則默認為無狀態（`A` 為 `null`）。
- **執行時機**：在流開始處理第一個元素之前，且僅執行一次（即使是並行流，每個線程也會獨立調用）。

### 作用
Initializer 負責設置 Gatherer 的內部狀態，例如創建一個集合、計數器或其他數據結構，用於後續的元素處理。如果你的 Gatherer 不需要狀態（例如簡單映射），可以省略。

### 示例
假設我們要實現一個累加器，計算流中所有數字的和，並在結束時輸出：
```java
Supplier<Integer> initializer = () -> 0; // 初始狀態為 0
